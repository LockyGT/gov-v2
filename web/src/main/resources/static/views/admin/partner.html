<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<style>
<!--
.modal-lg {
	max-width: 80% !important;
}
-->
</style>
<!-- Page Heading -->
<h1 class="my-4">
	USUARIOS <i class="fas fa-users-cog"></i><small></small>
</h1>
<section data-ng-show="legislator !== null">
	<div class="row">
		<div class="mx-auto col-sm-12 col-md-12 col-lg-12">
			<form name="partnerForm"
				data-ng-submit="submitForm(partnerForm.$valid)" novalidate>
				<div class="card">
					<div class="card-header">
						<h5 class="card-title">{{!legislator.id ? 'Nuevo ':
							'Actualizar '}}</h5>
					</div>
					<div class="card-body">
						<div class="form-group row">
							<label for="cboRol" class="col-sm-2 col-form-label">Rol
								del Usuario</label>
							<div class="input-group input-group-lg col-sm-10">
								<div class="input-group-prepend">
									<span class="input-group-text" id="inputGroup-sizing-lg">@</span>
								</div>
								<select class="form-control" id="cboRol" name="cboRol" required
									data-ng-options="rol.roleName for rol in userRols track by rol.id"
									data-ng-readonly="disableSelect"
									data-ng-model="legislator.user.userRol"
									data-ng-class="invalidClassRol">
									<option value="">Seleccione un Rol...</option>
								</select>
								<div class="invalid-feedback d-block"
									data-ng-show="invalidClassRol != null && invalidClassRol.length > 0 ">
									Por favor, seleccione un Rol</div>
							</div>
						</div>
						<div class="form-group row animate-if"
							data-ng-if="legislator.user.userRol.sku == _PARTNER._TYPE._LEGISLATOR">
							<label for="cboPartido" class="col-sm-2 col-form-label">Partido</label>
							<div class="input-group input-group-lg col-sm-10">
								<div class="input-group-prepend">
									<span class="input-group-text" id="inputGroup-sizing-lg2"><i
										class="fas fa-home"></i></span>
								</div>
								<select class="form-control" id="cboPartido"
									data-ng-options="politicalParty.name + ' (' + politicalParty.acronym + ')' for politicalParty in politicalParties track by politicalParty.id"
									data-ng-model="legislator.partido">
									<option value="">Seleccione un Partido...</option>
								</select>
							</div>
						</div>
						<div class="form-group row">
							<label for="txtNombre" class="col-sm-2 col-form-label">Nombre(s)</label>
							<div class="input-group input-group-lg col-sm-10">
								<div class="input-group-prepend">
									<span class="input-group-text" id="inputGroup-sizing-lg4"><i
										class="far fa-user"></i></span>
								</div>
								<input type="text" class="form-control" id="txtNombre"
									placeholder="Nombre" data-ng-model="legislator.name" required
									data-ng-class="invalidClassName" maxlength="250">
							</div>
						</div>
						<div class="form-group row">
							<label for="txtApPaterno" class="col-sm-2 col-form-label">Apellido
								Paterno</label>
							<div class="input-group input-group-lg col-sm-10">
								<div class="input-group-prepend">
									<span class="input-group-text" id="inputGroup-sizing-lg5"><i
										class="far fa-user"></i></span>
								</div>
								<input type="text" class="form-control" id="txtApPaterno"
									placeholder="Apellido Paterno"
									data-ng-model="legislator.apPaterno" required
									data-ng-class="invalidClassApPaterno" maxlength="250">
							</div>
						</div>
						<div class="form-group row">
							<label for="txtApMaterno" class="col-sm-2 col-form-label">Apellido
								Materno</label>
							<div class="input-group input-group-lg col-sm-10">
								<div class="input-group-prepend">
									<span class="input-group-text" id="inputGroup-sizing-lg6"><i
										class="far fa-user"></i></span>
								</div>
								<input type="text" class="form-control" id="txtApMaterno"
									placeholder="Apellido Materno"
									data-ng-model="legislator.apMaterno" required
									data-ng-class="invalidClassApMaterno" maxlength="250">
							</div>
						</div>
						<div class="form-group row">
							<label for="txtNacimiento" class="col-sm-2 col-form-label">Fecha
								de Nacimiento</label>
							<div class="input-group input-group-lg col-sm-10 date"
								id="datetimepicker1">
								<div class="input-group-prepend">
									<span class="input-group-text" id="inputGroupDate"><i
										class="fas fa-birthday-cake"></i></span> <input type="date"
										class="form-control" max="{{minAge | date:'yyyy-MM-dd'}}"
										name="fechaNac" data-ng-model="legislator.fechaCumplianos"
										aria-describedby="inputGroupDate" />
									<div class="invalid-feedback d-block"
										data-ng-show="!partnerForm.fechaNac.$valid">Por favor,
										introduce una fecha válida</div>
								</div>
							</div>
						</div>
						<div class="form-group row">
							<label for="txtTelefono" class="col-sm-2 col-form-label">Telefono
							</label>
							<div class="input-group input-group-lg col-sm-10">
								<div class="input-group-prepend">
									<span class="input-group-text" id="inputGroup-sizing-lg7"><i
										class="fas fa-mobile"></i></span>
								</div>
								<input type="tel" class="form-control" id="txtTelefono"
									name="txtTelefono" data-ng-pattern="ph_numbr"
									data-ng-minlength="10" data-ng-maxlength="10"
									placeholder="10 Digitos" data-ng-model="legislator.telefono"
									data-ng-class="!partnerForm.txtTelefono.$valid ? 'is-invalid' : '' ">
								<div class="invalid-feedback d-block"
									data-ng-show="!partnerForm.txtTelefono.$valid">Por favor,
									introduce una telefono válido</div>
							</div>
						</div>
						<div class="form-group row">
							<label for="txtEmail" class="col-sm-2 col-form-label">Email</label>
							<div class="input-group input-group-lg col-sm-10">
								<div class="input-group-prepend">
									<span class="input-group-text" id="inputGroup-sizing-lg8"><i
										class="fas fa-at"></i></span>
								</div>
								<input type="text" class="form-control" id="txtEmail"
									name="txtEmail" placeholder="mail@mail.com"
									data-ng-model="legislator.email" data-ng-pattern="emailFormat"
									data-ng-class="!partnerForm.txtEmail.$valid ? 'is-invalid' : '' ">
								<div class="invalid-feedback d-block"
									data-ng-show="!partnerForm.txtEmail.$valid">Por favor,
									introduce una direcci&oacute;n de email válido</div>
							</div>
						</div>
						<div class="form-group row">
							<label for="txtComisiones" class="col-sm-2 col-form-label">Comisiones</label>
							<div class="input-group input-group-lg col-sm-10">
								<div class="input-group-prepend">
									<span class="input-group-text" id="inputGroup-sizing-lg4"><i class="fas fa-tasks"></i></span>
								</div>
								<input type="text" class="form-control" id="txtComisiones"
									placeholder="Comisiones" name="txtComisiones" data-ng-model="legislator.comisiones"
									maxlength="250">
							</div>
						</div>
						<div class="form-group row">
							<label for="txtDistrict" class="col-sm-2 col-form-label">Distrito</label>
							<div class="input-group input-group-lg col-sm-10">
								<div class="input-group-prepend">
									<span class="input-group-text" id="inputGroup-sizing-lg4"><i class="fas fa-map-marker-alt"></i></span>
								</div>
								<input type="text" class="form-control" id="txtDistrict"
									placeholder="Distrito" name="txtDistrict" data-ng-model="legislator.distrito"
									maxlength="250">
							</div>
						</div>
						<div class="form-group row">
							<label for="txtLegislature" class="col-sm-2 col-form-label">Legislatura</label>
							<div class="input-group input-group-lg col-sm-10">
								<div class="input-group-prepend">
									<span class="input-group-text" id="inputGroup-sizing-lg4"><i class="fas fa-balance-scale"></i></span>
								</div>
								<input type="text" class="form-control" id="txtLegislature"
									placeholder="Legislatura" name="txtLegislature" data-ng-model="legislator.legislatura"
									maxlength="250">
							</div>
						</div>
						<div class="form-group row">
							<label for="txtUserName" class="col-sm-2 col-form-label">Nombre
								de Usuario</label>
							<div class="input-group input-group-lg col-sm-10">
								<div class="input-group-prepend">
									<span class="input-group-text" id="inputGroup-sizing-lg9"><i
										class="fas fa-user-lock"></i></span>
								</div>
								<input type="text" class="form-control" id="txtUserName"
									data-ng-model="legislator.user.username" required
									data-ng-class="invalidClassUsername">
							</div>
						</div>
						<!-- Foto de LEgislador -->
						<div class="row">
							<label for="txtFoto" class="col-sm-2 col-form-label">Foto</label>

							<div class="input-group input-group-lg image-preview col-sm-10">
								<div class="input-group-prepend">
									<span class="input-group-text" id="inputGroup-sizing-lg8"><i
										class="fas fa-camera"></i></span>
								</div>
								<!-- image-preview-filename input [CUT FROM HERE]-->


								<!-- don't give a name === doesn't send on POST/GET -->

								<input type="text" value="{{fileName ? fileName: 'Seleccione una imagen...'}}" class="form-control image-preview-filename"
									disabled="disabled">
								<div class="input-group-append">
									<button type="button"
										class="btn btn-default image-preview-clear"
										style="display: none;">
										<span class="glyphicon glyphicon-remove"></span>Borrar
									</button>
									<!-- image-preview-input -->
									<label class="btn btn-default image-preview-input"> <span
										class="glyphicon glyphicon-folder-open"></span> <span
										class="image-preview-input-title">Buscar</span> <input
										type="file" accept="image/png, image/jpeg"
										name="input-file-preview"
										data-fileread="legislator.foto.filePath" /> <!-- rename it -->
									</label>
								</div>
								<!-- /input-group image-preview [TO HERE]-->
							</div>
						</div>
						<br>
						<div class="row">
							<div class="col-sm-2"></div>
							<div class="col-sm-3">
								<img alt="Vista previa foto"
									data-ng-src="{{legislator.foto != null ? legislator.foto.filePath != null ? legislator.foto.filePath : './img/archivo-de-imagen.png' : './img/archivo-de-imagen.png' }}"
									onerror="this.src='./img/archivo-de-imagen.png'" width="100"
									height="100">
							</div>
						</div>
						<!-- User -->
						<br>
					</div>
					<!-- CardBody -->
					<div class="card-footer">
						<button type="submit" class="btn btn-success">
							<i class="fas"
								data-ng-class="!legislator.id
							? 'fa-plus': 'fa-sync'"></i>
							{{!legislator.id ? 'Guardar': 'Actualizar'}}
						</button>
						<button type="button" class="btn btn-danger"
							data-ng-click="cancelAddUpdateLegislator()">
							<i class="fas fa-times"></i> Cancelar
						</button>
					</div>
					<!-- CardFooter -->
				</div>
				<!-- Card -->
			</form>
		</div>
	</div>
</section>
<section data-ng-if="legislator === null">
	<div class="card">
		<div class="card-header">
			<div class="row">
				<div class="btn-group">
					<button type="button" class="btn btn-success"
						data-ng-click="addLegislator()">
						<i class="fas fa-user-plus"></i> Nuevo
					</button>
				</div>
				<div class="input-group col-md-4">
					<input class="form-control py-2" type="search" value="search"
						id="example-search-input" placeholder="Buscar"
						data-ng-model="searchPartner"> <span
						class="input-group-append"> </span>
				</div>
			</div>
		</div>
		<div class="card-body">
			<div class="row">
				<div class="alert alert-primary" role="alert"
					data-ng-if="!legislators.length">
					No se han encontrado usuarios registrador en el sistema <a
						data-ng-click="addLegislator()" style="cursor: pointer;"
						class="alert-link"><i class="fas fa-user-plus"></i> Agregue un
						usuario para comenzar</a>.
				</div>
				<div class="table-responsive" data-ng-if="legislators.length > 0">
					<table class="table table-inversed table-hover table-striped">
						<thead>
							<tr>
								<th>Nombre</th>
								<th>Rol</th>
								<th>Partido</th>
								<th>Nombre de usuario</th>
								<th></th>
								<th></th>
								<th></th>
								<th></th>
							</tr>
						</thead>
						<tfoot>
							<tr>
								<th></th>
								<th></th>
								<th></th>
								<th></th>
								<th></th>
								<th></th>
								<th></th>
								<th></th>
							</tr>
						</tfoot>
						<tbody>
							<tr
								data-ng-repeat="legislator in legislators  | filter : searchPartner track by legislator.id">
								<td>{{legislator.apPaterno}} {{legislator.apMaterno}}
									{{legislator.name}}</td>
								<td>{{legislator.user.userRol.roleName}}</td>
								<td style="color: {{legislator.partido.colour">{{legislator.partido.acronym}}</td>
								<td>{{legislator.user.username}}</td>
								<td>
									<button type="button" class="btn btn-warning"
										data-ng-click="updateLegislator(legislator)"
										data-ng-if="legislator.id != null">Actualizar</button>
								</td>
								<td>
									<button type="button" class="btn btn-info"
										data-ng-click="addDocuments(legislator)"
										data-ng-if="legislator.id != null">Documentos</button>
								</td>
								<td>
									<button type="button" class="btn btn-info"
										data-ng-click="addFingerPrints(legislator)"
										data-ng-if="legislator.id != null">Huellas</button>
								</td>
								
								<td>
									<button type="button" class="btn btn-danger"
										data-ng-click="confirmDelete('Esta Seguro de Eliminar a',legislator.name + ' ' + legislator.apPaterno + ' ' + legislator.apMaterno,legislator)"
										data-ng-if="legislator.id != null">Eliminar</button>
								</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
		</div>
	</div>
</section>

<div class="modal fade bd-example-modal-lg" id="myModal" tabindex="-1"
	role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
	<div class="modal-dialog modal-lg modal-dialog-centered"
		role="document">
		<div class="modal-content">
			<!-- Modal Header -->
			<div class="modal-header">
				<h4 class="modal-title">Huellas de {{legislatorHuella.name}}</h4>
				<button type="button" class="close" data-dismiss="modal">&times;</button>
			</div>

			<!-- Modal body -->
			<div class="modal-body">
				<ui-view />
			</div>

			<!-- Modal footer -->
			<div class="modal-footer">
				<button type="button" class="btn btn-danger" data-dismiss="modal">Cerrar</button>
			</div>
		</div>
	</div>
</div>
